!function(e){var i={};function t(o){if(i[o])return i[o].exports;var a=i[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=i,t.d=function(e,i,o){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var a in e)t.d(o,a,function(i){return e[i]}.bind(null,a));return o},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="",t(t.s=0)}([function(e,i,t){"use strict";t.r(i);class o{constructor(){this.item={}}async getData(e,i,t){const o=`http://www.omdbapi.com/?apikey=1ea6d4f9&&t=${e}`;let a;a=0===i.length&&"short"===t?o:0!==i.length&&"short"===t?`${o}&y=${i}`:0===i.length&&"full"===t?`${o}&plot=full`:`${o}&y=${i}&plot=full`,this.item=await(await fetch(a).then(e=>e.json()).catch(e=>e)),this.plot=t}getMovieFromFav(e,i){const t=i.findIndex(i=>i.imdbID===e);t<0?this.item.Response="False":this.item=i[t]}}class a{constructor(e,i){this.id=e,this.plot=i,this.item={}}async getDetail(){let e="";"full"===this.plot&&(e="&plot=full"),this.item=await(await fetch(`http://www.omdbapi.com/?apikey=1ea6d4f9&&i=${this.id}${e}`).then(e=>e.json()).catch(e=>e))}}class n{constructor(){this.arr=[]}createFav(e){this.arr.push(e),localStorage.setItem(e.imdbID,JSON.stringify(e))}deleteFav(e){let i;this.arr.forEach((t,o)=>{t.imdbID===e&&(i=o)}),this.arr.splice(i,1),localStorage.removeItem(e)}checkFav(e){return-1===this.arr.findIndex(i=>i.imdbID===e)}lengthFav(){return this.arr.length}startFav(){const e=Object.keys(localStorage);let i=e.length,t=0;for(;i--;)"loglevel:webpack-dev-server"!==e[i]&&(this.arr[t++]=JSON.parse(localStorage.getItem(e[i])))}}const l={movieTitle:document.querySelector(".title__search"),movieYear:document.querySelector(".year__search"),moviePlot:document.querySelector(".plot__search"),movieBtnSearch:document.querySelector(".btn__search"),movieBtnReset:document.querySelector(".btn__reset"),movieDisplay:document.querySelector(".movie-main"),favDisplay:document.querySelector(".fav__list"),favDisplayParent:document.querySelector(".fav__panel"),favHeartIcon:document.querySelector(".fav__search")},r=e=>{let i;if("False"===e.Response)i='\n        <div class="movie-box movie-result">\n            <div class="movie__title" style="color:#fff; width: 71vw;">\n            Sorry, we can\'t find that movie, or there is a problem with server ;(</div>\n        </div>\n        ';else{const t=v(e.Title);i=`\n        <div class="movie-box movie-result">\n            <img class="movie__photo" src="${e.Poster}" alt="Movie photo">\n            <div class="movie__title"><a href="#">${t}</a></div>\n            <div class="movie__rating">\n                <div class="movie__fav-icon"><ion-icon name="heart" class="movie__fav yellow-movieBtn"></ion-icon></div>\n                <ion-icon name="star" class="yellow"></ion-icon>${"N/A"!==e.Metascore?`${e.Metascore} / 100`:"N/A"}\n            </div>\n            <div class="movie__genre">${e.Genre}</div>\n            <div class="movie__ageTime">${e.Rated} | ${e.Runtime}</div>\n            <div class="movie__production">${e.Production}</div>\n        </div>\n        `}d(),l.movieDisplay.insertAdjacentHTML("afterbegin",i)},v=(e,i=18)=>{const t=[];let o=0;return e.length>i?([...e.split(" ")].forEach(e=>{o+e.length<=i&&(o+=e.length,t.push(e))}),`${t.join(" ")} ...`):e},s=()=>l.movieDisplay.classList.add("loader"),d=()=>l.movieDisplay.classList.remove("loader"),c=()=>l.movieDisplay.innerHTML="",m=()=>{l.movieTitle.value="",l.movieYear.value="";const e=l.moviePlot.options;0!==e&&(e.selectedIndex=0)},u=e=>{e.forEach(e=>{const i=v(e.Title),t=`\n            <a href="#" class="fav__link" id="${e.imdbID}">\n                <div class="fav__photo">\n                    <img src="${e.Poster}" alt="Movie img">\n                </div>\n                <div class="fav__title">${i}</div>\n            </a>\n            `;l.favDisplay.insertAdjacentHTML("beforeend",t)})},p=()=>l.favDisplay.innerHTML="",f=e=>{l.favHeartIcon.style.visibility=e?"visible":"hidden"},_=()=>{document.querySelector(".movie__fav").classList.toggle("yellow-movieBtn"),document.querySelector(".movie__fav").classList.toggle("red-movieBtn")},h={};l.movieBtnSearch.addEventListener("click",async()=>{""!==l.movieTitle.value&&((h.movie||h.detail)&&c(),s(),h.movie=new o,await h.movie.getData(l.movieTitle.value,l.movieYear.value,l.moviePlot.value),r(h.movie.item),h.favourite.checkFav(h.movie.item.imdbID)||_(),m())}),l.movieBtnReset.addEventListener("click",async()=>{(h.movie||h.detail)&&c(),m(),p(),h.movie&&delete h.movie,h.detail&&delete h.detail,delete h.favourite,localStorage.clear(),l.favHeartIcon.style.visibility="hidden"}),l.movieDisplay.addEventListener("click",async e=>{if(e.preventDefault(),e.target.matches(".movie__title, .movie__title *")){c(),s();let e=!0;h.detail&&(e=!1,h.detail.item.imdbID===h.movie.item.imdbID&&h.movie.plot===h.detail.plot||(delete h.detail,e=!0)),e&&(h.detail=new a(h.movie.item.imdbID,h.movie.plot),await h.detail.getDetail()),(e=>{let i;i="False"===e.Response?'\n        <div class="movie-box movie-result">\n            <div class="movie__title" style="color:#fff; width: 71vw;">\n            Sorry, we can\'t find that movie, or there is a problem with server ;(</div>\n        </div>\n        ':`\n        <div class="movie-box movie-detail">\n                <div class="movie-detail-container">\n                    <div class="movie-detail__intro">Więcej informacji o wybranym filmie</div>\n                    <div class="movie-detail__date">\n                        <div class="movie-detail__calendar">\n                            <ion-icon name="calendar"></ion-icon>\n                            <div>\n                                <p>DATA PREMIERY:</p>\n                                <p>${e.Released}</p>\n                            </div>\n                        </div>\n                        <div class="movie-detail__time">\n                            <ion-icon name="time"></ion-icon>\n                            <div>\n                                <p>CZAS TRWANIA:</p>\n                                <p>${e.Runtime}</p>\n                            </div>\n                        </div>\n                    </div>    \n                    <div class="movie-detail__descr">\n                        <p>${e.Plot}</p>\n                    </div>\n                    <div class="movie-detail__title">\n                        <p>TYTUŁ:</p><p>${e.Title}</p>\n                    </div>\n                    <div class="movie-detail__genre">\n                        <p>GATUNEK FILMU:</p><p>${e.Genre}</p>\n                    </div>\n                    <div class="movie-detail__actors">\n                        <p>OBSADA:</p><p>${e.Actors}</p>\n                    </div>\n                    <div class="movie-detail__director">\n                        <p>REŻYSER:</p><p>${e.Director}</p>\n                    </div>\n                    <div class="movie-detail__awards">\n                        <p>Nagrody:</p><p>${e.Awards}</p>\n                    </div>\n                    <div class="movie-detail__age">\n                        <p>OGRANICZENIA WIEKOWE:</p><p>${e.Rated}</p>\n                    </div>\n                </div>\n                <div class="movie-detail-rigth">\n                    <div class="movie-detail__like"><ion-icon name="heart" class="movie__fav yellow-movieBtn"></ion-icon></div>\n                    <img class="movie__photo" src="${e.Poster}" alt="Movie photo">\n                    <div class="movie-detail__return"><a href="#"><ion-icon name="arrow-round-back"></ion-icon>Return</a><div>\n                </div>\n            </div>\n        `,d(),l.movieDisplay.insertAdjacentHTML("afterbegin",i)})(h.detail.item),h.favourite.checkFav(h.detail.item.imdbID)||_()}else e.target.matches(".movie-detail__return *")?(c(),r(h.movie.item),h.favourite.checkFav(h.movie.item.imdbID)||_()):e.target.matches(".movie__fav-icon, .movie__fav-icon *, .movie-detail__like, .movie-detail__like *")&&(h.favourite||(h.favourite=new n),h.favourite.checkFav(h.movie.item.imdbID)?(h.favourite.createFav(h.movie.item),p(),u(h.favourite.arr)):(h.favourite.deleteFav(h.movie.item.imdbID),(e=>{const i=document.getElementById(e);i.parentNode.removeChild(i)})(h.movie.item.imdbID)),_(),f(h.favourite.lengthFav()))}),l.favDisplayParent.addEventListener("click",e=>{e.preventDefault(),m();let i=e.target.id;i||(i=e.target.parentNode.id),i&&(c(),h.movie=new o,h.movie.getMovieFromFav(i,h.favourite.arr),r(h.movie.item),h.favourite.checkFav(h.movie.item.imdbID)||_())}),window.addEventListener("load",()=>{h.favourite=new n,h.favourite.startFav(),f(h.favourite.lengthFav()),u(h.favourite.arr)})}]);